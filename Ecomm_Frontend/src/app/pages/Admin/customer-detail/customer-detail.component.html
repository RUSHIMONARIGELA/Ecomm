<div class="container mt-4">
  <div class="card shadow-lg rounded-3">
    <div class="card-header bg-primary text-white py-3">
      <h3 class="mb-0">Customer Details</h3>
    </div>
    <div class="card-body p-4">
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading customer details...</span>
        </div>
        <p class="mt-2">Loading customer details...</p>
      </div>

      <div
        *ngIf="error"
        class="alert alert-danger alert-dismissible fade show"
        role="alert"
      >
        {{ error }}
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
          (click)="error = null"
        ></button>
      </div>

      <div *ngIf="customer && !loading && !error">
        <div>
          <h5 class="mb-3 text-primary">Account Details</h5>
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <label class="form-label">Username</label>
              <div class="form-control-plaintext">{{ customer.userDetails ? customer.userDetails.username : '' }}</div>
            </div>
            <div class="col-12">
              <label class="form-label">Email</label>
              <div class="form-control-plaintext">{{ customer.userDetails ? customer.userDetails.email : '' }}</div>
            </div>
          </div>

          <h5 class="mb-3 text-primary">Personal Details</h5>
          <div class="row g-3 mb-4">
            <div class="col-md-6">
              <label class="form-label">First Name</label>
              <div class="form-control-plaintext">{{ customer.profileDetails ? customer.profileDetails.firstName : '' }}</div>
            </div>
            <div class="col-md-6">
              <label class="form-label">Last Name</label>
              <div class="form-control-plaintext">{{ customer.profileDetails ? customer.profileDetails.lastName : '' }}</div>
            </div>
            <div class="col-12">
              <label class="form-label">Phone Number</label>
              <div class="form-control-plaintext">{{ customer.profileDetails ? customer.profileDetails.phoneNumber : '' }}</div>
            </div>
          </div>

          <h5 class="mb-3 text-primary">Addresses</h5>
          <div *ngIf="customer.profileDetails && customer.profileDetails.addresses && customer.profileDetails.addresses.length > 0; else noAddresses">
            <div *ngFor="let address of customer.profileDetails.addresses; let i = index" class="card mb-3 shadow-sm address-card">
              <div class="card-body">
                <h6 class="card-subtitle mb-3 text-muted">Address #{{ i + 1 }}</h6>
                <div class="row g-3">
                  <div class="col-12">
                    <label class="form-label">Street Address</label>
                    <div class="form-control-plaintext">{{ address.street }}</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">City</label>
                    <div class="form-control-plaintext">{{ address.city }}</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">State/Province</label>
                    <div class="form-control-plaintext">{{ address.state }}</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Postal Code</label>
                    <div class="form-control-plaintext">{{ address.postalCode }}</div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Country</label>
                    <div class="form-control-plaintext">{{ address.country }}</div>
                  </div>
                  <div class="col-12">
                    <label class="form-label">Address Type</label>
                    <div class="form-control-plaintext">{{ address.type }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noAddresses>
            <div class="alert alert-warning text-center">
              No addresses found for this customer.
            </div>
          </ng-template>
          <div class="d-flex justify-content-end gap-2 mt-4">
            <button type="button" class="btn btn-outline-secondary" routerLink="/admin/customers">
              <i data-lucide="arrow-left" class="icon-small me-1"></i>Back to Customers
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  if (typeof lucide !== "undefined") {
    lucide.createIcons();
  }
</script>
